/*! MMIS115_25 - v1.0.0 - 2016-01-04
* Copyright (c) 2016 ondrej blazek; Licensed Apache-2.0 */
ModularMVC.registerController("controller",function(a,b){var c={getAppData:function(){var b=0,c=1,d=0,e=0,f=0,g=0;jQuery.getJSON("js/questions.json",function(h){var i,j=0,k=[],l=[];a().viewPics(h,b);for(var m=0;42>m;m++)k[m]=m+1;for(var n=0;42>n;n++){var o=Math.floor(4*Math.random()+1);l[o+j]=h.questions[b].q[1],i=h.questions[b].q[1];var p=Math.floor(Math.random()*k.length);d=0,e=0,f=0,g=0;for(var q=1;5>q;q++)if(o!==q)if(0===i.localeCompare(h.questions[p].q[1])){for(;0===i.localeCompare(h.questions[p].q[1]);)p=Math.floor(Math.random()*k.length);for(l[q+j]=h.questions[p].q[1],p=Math.floor(Math.random()*k.length);0===i.localeCompare(h.questions[p].q[1]);)p=Math.floor(Math.random()*k.length)}else{switch(l[q+j]=h.questions[p].q[1],q){case 1:d=p;break;case 2:e=p;break;case 3:f=p;break;case 4:g=p}for(p=Math.floor(Math.random()*k.length);d===p||e===p||f===p||g===p;)p=Math.floor(Math.random()*k.length)}b++,j+=4}a().viewLabels(l,c)})},nextClicked:function(b,c){c+=4,a().viewLabels(b,c)}};return c}(ModularMVC.View("view"),ModularMVC.MVCHelper("Widget"))),ModularMVC.registerHelper("helper.serverapi",function(a){var b={getUserProfileData:function(a,b,c){debug("helper.serverapi getUserProfileData: send a xhr request to fetch profile data from web service");var e={user_id:a,action:"getUserProfileData"};d(e,b,c)},getUserInterests:function(a,b,c){debug("helper.serverapi getUserInterests: send a xhr request to fetch user interests from web service");var e={user_id:a,action:"getUserInterests"};d(e,b,c)}},c="sampleAPI/",d=function(){};return d=function(b,d,e){var f="getUserProfileData"===b.action?"profile.json":"interests.json";a().httpGetJSON(c+f,b,function(a){return debug("helper.serverapi _sendRequest: the response has just arrived!"),debug(a),"undefined"!=typeof a.error?(debug("Server reported the following error while processing the request: "+a.error),void e("An error occurred. Please try again!")):void d(a)},function(a,b,c){debug("Request failed: "+c),e("An unexpected error occurred.")})},b}(ModularMVC.MVCHelper("Widget"))),function(){var a,b,c,d,e,f,g,h,i;if(c={version:"2.3.3",name:"jQuery-runner"},g=this.jQuery||this.Zepto||this.$,!g||!g.fn)throw new Error("["+c.name+"] jQuery or jQuery-like library is required for this plugin to work");e={},d=function(a){return(10>a?"0":"")+a},i=1,f=function(){return"runner"+i++},h=function(a,b){return a["r"+b]||a["webkitR"+b]||a["mozR"+b]||a["msR"+b]||function(a){return setTimeout(a,30)}}(this,"equestAnimationFrame"),b=function(a,b){var c,e,f,g,h,i,j,k,l,m,n;for(b=b||{},k=[36e5,6e4,1e3,10],i=["",":",":","."],h="",g="",f=b.milliseconds,e=k.length,l=0,0>a&&(a=Math.abs(a),h="-"),c=m=0,n=k.length;n>m;c=++m)j=k[c],l=0,a>=j&&(l=Math.floor(a/j),a-=l*j),(l||c>1||g)&&(c!==e-1||f)&&(g+=(g?i[c]:"")+d(l));return h+g},a=function(){function a(b,c,d){var h;return this instanceof a?(this.items=b,h=this.id=f(),this.settings=g.extend({},this.settings,c),e[h]=this,b.each(function(a,b){g(b).data("runner",h)}),this.value(this.settings.startAt),void((d||this.settings.autostart)&&this.start())):new a(b,c,d)}return a.prototype.running=!1,a.prototype.updating=!1,a.prototype.finished=!1,a.prototype.interval=null,a.prototype.total=0,a.prototype.lastTime=0,a.prototype.startTime=0,a.prototype.lastLap=0,a.prototype.lapTime=0,a.prototype.settings={autostart:!1,countdown:!1,stopAt:null,startAt:0,milliseconds:!0,format:null},a.prototype.value=function(a){this.items.each(function(b){return function(c,d){var e;c=g(d),e=c.is("input")?"val":"text",c[e](b.format(a))}}(this))},a.prototype.format=function(a){var c;return c=this.settings.format,(c=g.isFunction(c)?c:b)(a,this.settings)},a.prototype.update=function(){var a,b,c,d,e;this.updating||(this.updating=!0,c=this.settings,e=g.now(),d=c.stopAt,a=c.countdown,b=e-this.lastTime,this.lastTime=e,a?this.total-=b:this.total+=b,null!==d&&(a&&this.total<=d||!a&&this.total>=d)&&(this.total=d,this.finished=!0,this.stop(),this.fire("runnerFinish")),this.value(this.total),this.updating=!1)},a.prototype.fire=function(a){this.items.trigger(a,this.info())},a.prototype.start=function(){var a;this.running||(this.running=!0,(!this.startTime||this.finished)&&this.reset(),this.lastTime=g.now(),a=function(b){return function(){b.running&&(b.update(),h(a))}}(this),h(a),this.fire("runnerStart"))},a.prototype.stop=function(){this.running&&(this.running=!1,this.update(),this.fire("runnerStop"))},a.prototype.toggle=function(){this.running?this.stop():this.start()},a.prototype.lap=function(){var a,b;return b=this.lastTime,a=b-this.lapTime,this.settings.countdown&&(a=-a),(this.running||a)&&(this.lastLap=a,this.lapTime=b),b=this.format(this.lastLap),this.fire("runnerLap"),b},a.prototype.reset=function(a){var b;a&&this.stop(),b=g.now(),"number"!=typeof this.settings.startAt||this.settings.countdown||(b-=this.settings.startAt),this.startTime=this.lapTime=this.lastTime=b,this.total=this.settings.startAt,this.value(this.total),this.finished=!1,this.fire("runnerReset")},a.prototype.info=function(){var a;return a=this.lastLap||0,{running:this.running,finished:this.finished,time:this.total,formattedTime:this.format(this.total),startTime:this.startTime,lapTime:a,formattedLapTime:this.format(a),settings:this.settings}},a}(),g.fn.runner=function(b,d,f){var h,i;switch(b||(b="init"),"object"==typeof b&&(f=d,d=b,b="init"),h=this.data("runner"),i=h?e[h]:!1,b){case"init":new a(this,d,f);break;case"info":if(i)return i.info();break;case"reset":i&&i.reset(d);break;case"lap":if(i)return i.lap();break;case"start":case"stop":case"toggle":if(i)return i[b]();break;case"version":return c.version;default:g.error("["+c.name+"] Method "+b+" does not exist")}return this},g.fn.runner.format=b}.call(this),ModularMVC.registerModel("model",function(){var a={setInterests:function(a){debug("Model setInterest: set the user interests"),b=a},getInterests:function(){return debug("Model getInterests: return the user interests"),b}},b=null;return a}()),ModularMVC.registerView("view",function(a,b){var c={onWidgetReady:function(){d()},viewPics:function(a,c){b("input:radio[name=radio-choice]").prop("checked",!1).checkboxradio("refresh"),b("#head2").text(a.questions[c].q[0]),b("#img_1").attr("src",a.questions[c].img[0]),b("#img_2").attr("src",a.questions[c].img[1]),b("#next").click(function(){c++,c>0&&b("#back").show(),41===c&&b("#next").hide(),b("#head2").text(a.questions[c].q[0]),b("#img_1").attr("src",a.questions[c].img[0]),b("#img_2").attr("src",a.questions[c].img[1])})},viewLabels:function(a,c){b("label[for=radio1]").html(a[c]),b("label[for=radio2]").html(a[c+1]),b("label[for=radio3]").html(a[c+2]),b("label[for=radio4]").html(a[c+3]),b("#radio1").attr("value",a[c]),b("#radio2").attr("value",a[c+1]),b("#radio3").attr("value",a[c+2]),b("#radio4").attr("value",a[c+3]),b("#next").click(function(){c+=4,b("label[for=radio1]").html(a[c]),b("label[for=radio2]").html(a[c+1]),b("label[for=radio3]").html(a[c+2]),b("label[for=radio4]").html(a[c+3]),b("#radio1").attr("value",a[c]),b("#radio2").attr("value",a[c+1]),b("#radio3").attr("value",a[c+2]),b("#radio4").attr("value",a[c+3])})}},d=function(){b(".starts").click(function(){a().getAppData(),b("#next").show(),b("#setRunner").runner(),b("#setRunner").runner("start")})};return c}(ModularMVC.Controller("controller"),jQuery));