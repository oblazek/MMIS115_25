/*! MMIS115_25 - v1.0.0 - 2016-03-03
* Copyright (c) 2016 Ondrej Blazek,Cecilia Ritzén; Licensed Apache-2.0 */
ModularMVC.registerController("controller",function(a,b,c){var d={getAppData:function(){var d=b().getJSONData(),e=42,f=0,g=1,h=0,i=0,j=0,k=0;if(null==d)c().getServerData(function(c){b().setJSONData(c);var d,l=0,m=[],n=[];a().viewPics(c,f);for(var o=0;e>o;o++)m[o]=o+1;for(var p=0;e>p;p++){var q=Math.floor(4*Math.random()+1);n[q+l]=c.questions[f].q[1],d=c.questions[f].q[1];var r=Math.floor(Math.random()*m.length);h=0,i=0,j=0,k=0;for(var s=1;5>s;s++)if(q!==s)if(0===d.localeCompare(c.questions[r].q[1])){for(;0===d.localeCompare(c.questions[r].q[1]);)r=Math.floor(Math.random()*m.length);for(n[s+l]=c.questions[r].q[1],r=Math.floor(Math.random()*m.length);0===d.localeCompare(c.questions[r].q[1]);)r=Math.floor(Math.random()*m.length)}else{switch(n[s+l]=c.questions[r].q[1],s){case 1:h=r;break;case 2:i=r;break;case 3:j=r;break;case 4:k=r}for(r=Math.floor(Math.random()*m.length);h===r||i===r||j===r||k===r;)r=Math.floor(Math.random()*m.length)}f++,l+=4}a().viewLabels(n,g)},function(a){debug(a)});else{var l,m=0,n=[],o=[];a().viewPics(d,f);for(var p=0;e>p;p++)n[p]=p+1;for(var q=0;e>q;q++){var r=Math.floor(4*Math.random()+1);o[r+m]=d.questions[f].q[1],l=d.questions[f].q[1];var s=Math.floor(Math.random()*n.length);h=0,i=0,j=0,k=0;for(var t=1;5>t;t++)if(r!==t)if(0===l.localeCompare(d.questions[s].q[1])){for(;0===l.localeCompare(d.questions[s].q[1]);)s=Math.floor(Math.random()*n.length);for(o[t+m]=d.questions[s].q[1],s=Math.floor(Math.random()*n.length);0===l.localeCompare(d.questions[s].q[1]);)s=Math.floor(Math.random()*n.length)}else{switch(o[t+m]=d.questions[s].q[1],t){case 1:h=s;break;case 2:i=s;break;case 3:j=s;break;case 4:k=s}for(s=Math.floor(Math.random()*n.length);h===s||i===s||j===s||k===s;)s=Math.floor(Math.random()*n.length)}f++,m+=4}a().viewLabels(o,g)}}};return d}(ModularMVC.View("view"),ModularMVC.Model("model"),ModularMVC.Helper("helper.serverapi"))),ModularMVC.registerHelper("helper.init",function(a,b){var c={onWidgetReady:function(){var c=a().getPreference("lang");b().properties({usefile:!1,language:c,translations:{en:{START_BUTTON:"START",BACK:"Back",NEXT:"Next",QUIZ:"The Geography Quiz",RESULTS:"Results",RESULT:"Result!",WELCOME:"Welcome to the Geography Quiz. This application tests your European country skills. Press Start to begin the journey!",LANG:"Deutsch",TIME:"Your time: ",RIGHT_ANSWER:"Correct answer #<br>",WRONG_ANSWER:"Incorrect answer #<br>",CONGRATZ:"Congratulations! You made it through the quiz. Your result is: "},de:{START_BUTTON:"Anfang",BACK:"Zurück",NEXT:"Nächsten",QUIZ:"Die Geographie-Quiz",RESULTS:"Ergebnisse",RESULT:"Ergebnis!",WELCOME:"Willkommen in der Geographie-Quiz. Diese Anwendung testet Ihre Fähigkeiten europäischen Land. Drücken Sie auf Start, um die Reise zu beginnen!",LANG:"English",TIME:"Ihr Zeit: ",RIGHT_ANSWER:"Korrekte Antwort #<br>",WRONG_ANSWER:"Falsche Antwort #<br>",CONGRATZ:"Herzliche Glückwünsche! Sie machten es durch das Quiz. Ihr Ergebnis: "}}})}};return c}(ModularMVC.MVCHelper("Widget"),ModularMVC.MVCHelper("Language"))),ModularMVC.registerHelper("helper.serverapi",function(a){var b={getServerData:function(a,b){d(a,b)}},c="js/",d=function(b,d){var e="en"===a().getPreference("lang")?"questions.json":"fragen.json";jQuery.getJSON(c+e,function(a){b(a)}).fail(function(){d("Couldn't get data from the server!"),debug("error")})};return b}(ModularMVC.MVCHelper("Widget"))),function(){var a,b,c,d,e,f,g,h,i;if(c={version:"2.3.3",name:"jQuery-runner"},g=this.jQuery||this.Zepto||this.$,!g||!g.fn)throw new Error("["+c.name+"] jQuery or jQuery-like library is required for this plugin to work");e={},d=function(a){return(10>a?"0":"")+a},i=1,f=function(){return"runner"+i++},h=function(a,b){return a["r"+b]||a["webkitR"+b]||a["mozR"+b]||a["msR"+b]||function(a){return setTimeout(a,30)}}(this,"equestAnimationFrame"),b=function(a,b){var c,e,f,g,h,i,j,k,l,m,n;for(b=b||{},k=[36e5,6e4,1e3,10],i=["",":",":","."],h="",g="",f=b.milliseconds,e=k.length,l=0,0>a&&(a=Math.abs(a),h="-"),c=m=0,n=k.length;n>m;c=++m)j=k[c],l=0,a>=j&&(l=Math.floor(a/j),a-=l*j),(l||c>1||g)&&(c!==e-1||f)&&(g+=(g?i[c]:"")+d(l));return h+g},a=function(){function a(b,c,d){var h;return this instanceof a?(this.items=b,h=this.id=f(),this.settings=g.extend({},this.settings,c),e[h]=this,b.each(function(a,b){g(b).data("runner",h)}),this.value(this.settings.startAt),void((d||this.settings.autostart)&&this.start())):new a(b,c,d)}return a.prototype.running=!1,a.prototype.updating=!1,a.prototype.finished=!1,a.prototype.interval=null,a.prototype.total=0,a.prototype.lastTime=0,a.prototype.startTime=0,a.prototype.lastLap=0,a.prototype.lapTime=0,a.prototype.settings={autostart:!1,countdown:!1,stopAt:null,startAt:0,milliseconds:!0,format:null},a.prototype.value=function(a){this.items.each(function(b){return function(c,d){var e;c=g(d),e=c.is("input")?"val":"text",c[e](b.format(a))}}(this))},a.prototype.format=function(a){var c;return c=this.settings.format,(c=g.isFunction(c)?c:b)(a,this.settings)},a.prototype.update=function(){var a,b,c,d,e;this.updating||(this.updating=!0,c=this.settings,e=g.now(),d=c.stopAt,a=c.countdown,b=e-this.lastTime,this.lastTime=e,a?this.total-=b:this.total+=b,null!==d&&(a&&this.total<=d||!a&&this.total>=d)&&(this.total=d,this.finished=!0,this.stop(),this.fire("runnerFinish")),this.value(this.total),this.updating=!1)},a.prototype.fire=function(a){this.items.trigger(a,this.info())},a.prototype.start=function(){var a;this.running||(this.running=!0,(!this.startTime||this.finished)&&this.reset(),this.lastTime=g.now(),a=function(b){return function(){b.running&&(b.update(),h(a))}}(this),h(a),this.fire("runnerStart"))},a.prototype.stop=function(){this.running&&(this.running=!1,this.update(),this.fire("runnerStop"))},a.prototype.toggle=function(){this.running?this.stop():this.start()},a.prototype.lap=function(){var a,b;return b=this.lastTime,a=b-this.lapTime,this.settings.countdown&&(a=-a),(this.running||a)&&(this.lastLap=a,this.lapTime=b),b=this.format(this.lastLap),this.fire("runnerLap"),b},a.prototype.reset=function(a){var b;a&&this.stop(),b=g.now(),"number"!=typeof this.settings.startAt||this.settings.countdown||(b-=this.settings.startAt),this.startTime=this.lapTime=this.lastTime=b,this.total=this.settings.startAt,this.value(this.total),this.finished=!1,this.fire("runnerReset")},a.prototype.info=function(){var a;return a=this.lastLap||0,{running:this.running,finished:this.finished,time:this.total,formattedTime:this.format(this.total),startTime:this.startTime,lapTime:a,formattedLapTime:this.format(a),settings:this.settings}},a}(),g.fn.runner=function(b,d,f){var h,i;switch(b||(b="init"),"object"==typeof b&&(f=d,d=b,b="init"),h=this.data("runner"),i=h?e[h]:!1,b){case"init":new a(this,d,f);break;case"info":if(i)return i.info();break;case"reset":i&&i.reset(d);break;case"lap":if(i)return i.lap();break;case"start":case"stop":case"toggle":if(i)return i[b]();break;case"version":return c.version;default:g.error("["+c.name+"] Method "+b+" does not exist")}return this},g.fn.runner.format=b}.call(this),ModularMVC.registerModel("model",function(){var a={setJSONData:function(a){b=a},getJSONData:function(){return b}},b=null;return a}({})),ModularMVC.registerView("view",function(a,b,c,d){var e={onWidgetReady:function(){b().translatePage("home"),f()},viewPics:function(a,b){c().trace(),d("input:radio[name=radio-choice]").prop("checked",!1).checkboxradio("refresh"),d("#head2").text(a.questions[b].q[0]),d("#img_1").attr("src",a.questions[b].img[0]),d("#img_2").attr("src",a.questions[b].img[1]),d("#results").click(function(){41===b&&(d("input:radio[name=radio-choice]:checked").attr("value")===a.questions[b].q[1]?(d("#rightAnswers").css("color","#00ff00"),d("#rightAnswers").append(b+1+": "+a.questions[b].q[1]+"<br>")):(d("#wrongAnswers").css("color","red"),d("#wrongAnswers").append(b+1+": "+d("input:radio[name=radio-choice]:checked").attr("value")+"<br>")))}),d("#next").click(function(){d("input:radio[name=radio-choice]:checked").attr("value")===a.questions[b].q[1]?(d("#rightAnswers").css("color","#00ff00"),d("#rightAnswers").append(b+1+": "+a.questions[b].q[1]+"<br>")):(d("#wrongAnswers").css("color","red"),d("#wrongAnswers").append(b+1+": "+d("input:radio[name=radio-choice]:checked").attr("value")+"<br>")),d("input:radio[name=radio-choice]").prop("checked",!1).checkboxradio("refresh"),b++,b>0&&d("#back").show(),41===b&&d("#next").hide(),d("#head2").text(a.questions[b].q[0]),d("#img_1").attr("src",a.questions[b].img[0]),d("#img_2").attr("src",a.questions[b].img[1])}),d("#back").click(function(){42>b&&d("#next").show(),b>=1&&b--,0===b&&d("#back").hide(),d("input:radio[name=radio-choice]").prop("checked",!1).checkboxradio("refresh"),d("#head2").text(a.questions[b].q[0]),d("#img_1").attr("src",a.questions[b].img[0]),d("#img_2").attr("src",a.questions[b].img[1])})},viewLabels:function(a,b){d("label[for=radio1]").html(a[b]),d("label[for=radio2]").html(a[b+1]),d("label[for=radio3]").html(a[b+2]),d("label[for=radio4]").html(a[b+3]),d("#radio1").attr("value",a[b]),d("#radio2").attr("value",a[b+1]),d("#radio3").attr("value",a[b+2]),d("#radio4").attr("value",a[b+3]),d("#next").click(function(){b+=4,d("label[for=radio1]").html(a[b]),d("label[for=radio2]").html(a[b+1]),d("label[for=radio3]").html(a[b+2]),d("label[for=radio4]").html(a[b+3]),d("#radio1").attr("value",a[b]),d("#radio2").attr("value",a[b+1]),d("#radio3").attr("value",a[b+2]),d("#radio4").attr("value",a[b+3])}),d("#back").click(function(){b>=1&&(b-=4),d("label[for=radio1]").html(a[b]),d("label[for=radio2]").html(a[b+1]),d("label[for=radio3]").html(a[b+2]),d("label[for=radio4]").html(a[b+3])})}},f=function(){d("#languageSwitch").click(function(){"en"===c().getPreference("lang")?(c().setPreference("lang","de"),location.reload(!1)):(c().setPreference("lang","en"),b().translatePage("home"),location.reload(!1))}),d(".starts").click(function(){a().getAppData(),b().translatePage("start"),d("#next").show(),d("#setRunner").runner(),d("#setRunner").runner("start")}),d("#results").click(function(){b().translatePage("result"),d("#setRunner").runner("stop"),d("#getRunner").append(d("#setRunner").runner("lap"))})};return e}(ModularMVC.Controller("controller"),ModularMVC.MVCHelper("Language"),ModularMVC.MVCHelper("Widget"),jQuery));