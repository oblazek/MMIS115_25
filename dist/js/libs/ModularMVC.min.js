/*!
* ModularMVC framework
* 
* Dependencies:
*  - jQuery - see http://jquery.com
*  - jquery.yalm - see https://github.com/vltugraz/jquery.yalm (already included in ModularMVC.min.js)
*  - JSModuleMan - see https://github.com/vltugraz/JSModuleMan (already included in ModularMVC.min.js)
*  - JSTemplateX - see  https://github.com/vltugraz/JSTemplateX (already included in ModularMVC.min.js)
*  - SJTX ... Simple JavaScript Template X (already included in ModularMVC.min.js)
*    see  https://github.com/vltugraz/SJTX
*    LICENSE: MIT License, http://opensource.org/licenses/mit-license.php
*    based on:
*       "Simple JavaScript Templating", John Resig - http://ejohn.org/ 
*       MIT Licensed, http://opensource.org/licenses/mit-license.php
*  - JSTemplateX module for SJTX - see https://github.com/vltugraz/JSTemplateX (already included in ModularMVC.min.js)
* 
*/
var JSModuleMan=function(){return function(){var e={},t="object",n="JSModuleMan"+(new Date).getTime(),r=function(e){return typeof e===t?e:{}},i=function(e){return e[n]=function(){var e={};for(var t in this){if(t==n)continue;var r=this[t],i=typeof r,s=[],o=!1;i=="function"&&(s=r.toString().match(/\(.*?\)/)[0].replace(/[()]/gi,"").replace(/\s/gi,"").split(","),s=s.length==1&&s[0]===""?[]:s,o=r.toString().replace(/[\s]+/gi,"-").search(/return-([^;]+);/),o=o!=-1),e[t]={name:t,type:i,args:s,hasReturnValue:o}}return e},e},s={addModule:function(t,n,s,o){return o=typeof o=="boolean"?o:!1,this.moduleExists(t,n)&&!o?!1:(e[t]===undefined&&(e[t]={}),s=r(s),e[t][n]=i(s),this.moduleExists(t,n)?!0:!1)},getModule:function(t,n){return t===undefined?e:n===undefined?e[t]===undefined?{}:e[t]:this.moduleExists(t,n)?r(e[t][n]):{}},moduleExists:function(t,n){return t===undefined||n===undefined?!1:e[t]===undefined?!1:e[t][n]===undefined?!1:!0},removeAll:function(){e={}},removeModule:function(t,n){t===undefined?this.removeAll():n===undefined?delete e[t]:this.moduleExists(t,n)&&delete e[t][n]},moduleInfo:function(t,r){var i={};if(t===undefined)for(var s in e)i[s]=this.moduleInfo(s);else if(r===undefined){var o=e[t];for(var u in o)i[u]=this.moduleInfo(t,u)}else i=this.moduleExists(t,r)?this.getModule(t,r)[n]():{};return i}};return s}}(),YALM=function(e,t){"use strict";var n=function(e){var t=e instanceof Array?[]:{},r;for(r in e)e.hasOwnProperty(r)&&(e[r]&&typeof e[r]=="object"?t[r]=n(e[r]):t[r]=e[r]);return t},r="en",i={usefile:!1,filecontainsalltranslations:!1,alltranslationsfilename:"all",language:r,loaddefaultlang:!0,defaultlang:r,path:"",translations:{}},s=n(i);return t.reset=function(){s=n(i)},t.properties=function(t){s=e.extend(s,t);var n=s.path,r=s.language;(!!s.loaddefaultlang||r!==s.defaultlang)&&s.usefile&&(n=n.charAt(n.length-1)==="/"?n:n+"/",s.filecontainsalltranslations?(s.translations={},e.ajax({async:!1,type:"GET",url:n+s.alltranslationsfilename+".json",dataType:"json",success:function(e){s.translations=e},error:function(){}})):(s.translations[r]={},e.ajax({async:!1,type:"GET",url:n+r+".json",dataType:"json",success:function(e){s.translations[r]=e},error:function(){}})))},t.translate=function(e,t){var n=e,r=t!==undefined?t:s.language;return s.translations[r]!==undefined&&s.translations[r][e]!==undefined&&(n=s.translations[r][e]),n},t.getCurrentLanguage=function(){return s.language},t}(jQuery,{}),TemplateLoader=function(e){var t="text/x-templateloader-template",n=function(t){return e("#"+t).length?!0:!1},r=function(r,i,s,o){s=typeof s=="boolean"?s:!0,o=typeof o=="boolean"?o:!1;var u=n(i);u;var a=!u||u&&o;if(a){var f=document.createElement("script");f.setAttribute("id",i),f.setAttribute("type",t);if(!s)f.text=r;else{var l=!1;e.ajax({async:!1,url:r,dataType:"text",success:function(e){f.text=e,l=!0},error:function(e,t,n){}});if(!l)return!1}document.getElementsByTagName("head")[0].appendChild(f)}return n(i)?!0:!1},i={loadTemplateFromFileIntoDOM:function(e,t,n){return r(e,t,!0,n)},loadTemplateFromStringIntoDOM:function(e,t,n){return r(e,t,!1,n)},loadTemplateIntoDOM:function(e,t,n,i){return r(e,t,n,i)},removeTemplateFromDOM:function(t){return e("#"+t).remove(),n(t)?!1:!0},removeAllTemplatesFromDOM:function(){return e('script[type*="'+t+'"]').each(function(){e(this).remove()}),!0}};return i}(jQuery),JSTemplateX=function(e){"use strict";var t="function",n="object",r="templatemodule",i="helper",s=function(e){return e!==undefined&&e!==null&&typeof e===n&&o(e.doProceed)&&o(e.doConfigure)?!0:!1},o=function(e){return typeof e===t?!0:!1},u=function(t){return e.getModule(r,t)},a={registerTemplateLibrary:function(t,n){if(!o(n))return!1;n=n(new JSTemplateXModuleInterface(String(t).toLowerCase()));if(!s(n))return!1;var i=e.addModule(r,t,n,!0);return i,i},templateLibrarayExists:function(t){return e.moduleExists(r,t)},configure:function(e,t){var n=u(e);return n.configure(t)},proceed:function(e,t,n){var r=u(e);return r.proceed(t,n)},proceedAndRender:function(e,t,n,r){var i=u(e);return i.proceedAndRender(t,n,r)},registerHelper:function(t,n){return e.addModule(i,t,n,!0)},getHelper:function(t){return function(){return e.getModule(i,t)}}};return a}(new JSModuleMan),JSTemplateXInstance=function(e){"use strict";var t=null,n={selectTemplateLibrary:function(n){return e.templateLibrarayExists(n)?(t=n,!0):!1},getSelectedTemplateLibrary:function(){return t},configure:function(n){return t===null?!1:e.configure(t,n)},proceed:function(n,r){return t===null?null:e.proceed(t,n,r)},proceedAndRender:function(n,r,i){return t===null?!1:e.proceedAndRender(t,n,r,i)}};return n}(JSTemplateX);JSTemplateX.registerHelper("TemplateLoader",TemplateLoader);var JSTemplateXModuleInterface=function(e,t,n){return function(t){var r=function(e){var t=e instanceof Array?[]:{},n;for(n in e)e.hasOwnProperty(n)&&(e[n]&&typeof e[n]=="object"?t[n]=r(e[n]):t[n]=e[n]);return t},i="tmpl_"+(t!==undefined?String(t):"undefname")+"_"+(new Date).getTime()+"_",s={usingTemplatesFiles:!0,templates:{},loadIntoDOM:!0,replaceExistingDOM:!1,removeTemplateFromDomAfterRender:!1,useTemplatePrefix:!0},o=r(s),u=function(e){return(o.useTemplatePrefix?i:"")+e},a=function(e,t,r){var i=!1;if(r===undefined){if(o.templates[e]===undefined)return!1;r=o.templates[e],i=o.usingTemplatesFiles}return n().loadTemplateIntoDOM(r,t,i,o.replaceExistingDOM)},f=function(e){return n().removeTemplateFromDOM(e)},l=function(e){return o.loadIntoDOM?a(e,u(e)):!0},c=function(e){return o.loadIntoDOM&&o.removeTemplateFromDomAfterRender?f(u(e)):!0},h={};return h.configure=function(t){return o=e.extend(o,t),e.isFunction(h.doConfigure)?h.doConfigure(o):!1},h.proceed=function(t,n){if(!e.isFunction(h.doProceed))return null;if(!l(t))return null;var r=h.doProceed(t,u(t),n);return r===null||r===undefined?null:c(t)?r:null},h.proceedAndRender=function(t,n,r){var i=e.isFunction(h.doProceedAndRender);!i;if(!l(t))return!1;if(i){if(!h.doProceedAndRender(t,u(t),n,r))return!1}else{var s=h.doProceed(t,u(t),n);if(s===null||s===undefined)return!1;e(r).html(s)}return c(t)?!0:!1},h.getDOMTemplateID=function(e){return u(e)},h.loadTemplateIntoDOM=function(e,t,n){return a(e,t,n)},h.removeTemplateFromDOM=function(e){return f(e)},h}}(jQuery,JSTemplateX,JSTemplateX.getHelper("TemplateLoader")),SJTX=function(){var e={},t={tmpl:function(t,n,r){return r=typeof r=="boolean"?r:!1,fn=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[t]=e[t]||this.tmpl(r?t:document.getElementById(t).innerHTML),n?fn(n):fn}};return t}();JSTemplateX.registerTemplateLibrary("SJTX",function(e,t){return function(e){var n={};return e.doConfigure=function(e){return n=e,!0},e.doProceed=function(e,r,i){var s=r;return!n.usingTemplatesFiles&&!n.loadIntoDOM&&(s=n.templates[e]),t.tmpl(s,i)},e}}(jQuery,SJTX));var ModularMVC=function(e,t){var n="function",r=""+(new Date).getTime(),i="MVChelper"+r,s="helper"+r,o="controller"+r,u="model"+r,a="view"+r,f=function(){},l=function(){window.onLoad=function(){var e=t.getModule(i);for(var r in e){var l=t.getModule(i,r);typeof l.onWidgetReady===n&&(l.onWidgetReady(),l.onWodgetReady=f)}var c=t.getModule(s);for(var h in c){var p=t.getModule(s,h);typeof p.onWidgetReady===n&&(p.onWidgetReady(),p.onWodgetReady=f)}var d=t.getModule(u);for(var v in d){var m=t.getModule(u,v);typeof m.onWidgetReady===n&&(m.onWidgetReady(),m.onWodgetReady=f)}var g=t.getModule(a);for(var y in g){var b=t.getModule(a,y);typeof b.onWidgetReady===n&&(b.onWidgetReady(),b.onWodgetReady=f)}var w=t.getModule(o);for(var E in w){var S=t.getModule(o,E);typeof S.onWidgetReady===n&&(S.onWidgetReady(),S.onWodgetReady=f)}}},c=function(){e(document).ready(function(){h();var e=t.getModule(i);for(var r in e){var l=t.getModule(i,r);typeof l.onDomReady===n&&(l.onDomReady(),l.onDomReady=f)}var c=t.getModule(s);for(var p in c){var d=t.getModule(s,p);typeof d.onDomReady===n&&(d.onDomReady(),d.onDomReady=f)}var v=t.getModule(u);for(var m in v){var g=t.getModule(u,m);typeof g.onDomReady===n&&(g.onDomReady(),g.onDomReady=f)}var y=t.getModule(a);for(var b in y){var w=t.getModule(a,b);typeof w.onDomReady===n&&(w.onDomReady(),w.onDomReady=f)}var E=t.getModule(o);for(var S in E){var x=t.getModule(o,S);typeof x.onDomReady===n&&(x.onDomReady(),x.onDomReady=f)}})},h=function(){e(window).resize(function(){var r=t.getModule(a),i=e(this),s=i.width(),o=i.height();for(var u in r){var f=t.getModule(a,u);typeof f.onResize===n&&f.onResize(s,o)}})},p=function(e){var r=t.getModule(s);for(var i in r){var o=t.getModule(s,i);typeof o.onInitialize===n&&o.onInitialize(e)}},d=function(e){var r=t.getModule(u);for(var i in r){var s=t.getModule(u,i);typeof s.onInitialize===n&&s.onInitialize(e)}},v=function(e){var r=t.getModule(a);for(var i in r){var s=t.getModule(a,i);typeof s.onInitialize===n&&s.onInitialize(e)}},m=function(e){var r=t.getModule(o);for(var i in r){var s=t.getModule(o,i);typeof s.onInitialize===n&&s.onInitialize(e)}},g={registerModel:function(e,r,i){var s=t.addModule(u,e,r,i),o=t.getModule(u,e);return s&&typeof o.onRegister===n&&(o.onRegister(),o.onRegister=f),s},registerView:function(e,r,i){var s=t.addModule(a,e,r,i),o=t.getModule(a,e);return s&&typeof o.onRegister===n&&(o.onRegister(),o.onRegister=f),s},registerController:function(e,r,i){var s=t.addModule(o,e,r,i),u=t.getModule(o,e);return s&&typeof u.onRegister===n&&(u.onRegister(),u.onRegister=f),s},registerHelper:function(e,r,i){var o=t.addModule(s,e,r,i),u=t.getModule(s,e);return o&&typeof u.onRegister===n&&(u.onRegister(),u.onRegister=f),o},registerMVCHelper:function(e,r){var s=t.addModule(i,e,r,!1),o=t.getModule(i,e);return s&&typeof o.onRegister===n&&(o.onRegister(),o.onRegister=f),s},Model:function(e){return function(){return t.getModule(u,e)}},View:function(e){return function(){return t.getModule(a,e)}},Controller:function(e){return function(){return t.getModule(o,e)}},Helper:function(e){return function(){return t.getModule(s,e)}},MVCHelper:function(e){return function(){return t.getModule(i,e)}},initHelpers:p,initModels:d,initViews:v,initControllers:m,initAll:function(e){this.initHelpers(e),this.initModels(e),this.initViews(e),this.initControllers(e)},unregisterAll:function(){this.unregisterHelper(),this.unregisterModel(),this.unregisterView(),this.unregisterController()},unregisterModel:function(e){t.removeModule(u,e)},unregisterView:function(e){t.removeModule(a,e)},unregisterController:function(e){t.removeModule(o,e)},unregisterHelper:function(e){t.removeModule(s,e)},modelExists:function(e){return t.moduleExists(u,e)},viewExists:function(e){return t.moduleExists(a,e)},controllerExists:function(e){return t.moduleExists(o,e)},helperExists:function(e){return t.moduleExists(s,e)},getHelperDocs:function(e){return t.moduleInfo(s,e)},getModelDocs:function(e){return t.moduleInfo(u,e)},getViewDocs:function(e){return t.moduleInfo(a,e)},getControllerDocs:function(e){return t.moduleInfo(o,e)},getAllDocs:function(){return{Controllers:this.getControllerDocs(),Helpers:this.getHelperDocs(),Models:this.getModelDocs(),Views:this.getViewDocs()}}};return c(),l(),g}(jQuery,new JSModuleMan);ModularMVC.registerMVCHelper("Widget",function(){var e,t="pleWidgetEngine",n="http://ple.tugraz.at/ns/event/statistics",r=function(){(!e.defaultTitle||!e.defaultTitle.length)&&window.alert("Set a title in config file!"),(!e.authorName||!e.authorName.length)&&window.alert("Set the name of the developer (team leader) in config file!"),(!e.authorEmail||!e.authorEmail.length)&&window.alert("Set email address of the developer (team leader) in config file!")},i={onWidgetReady:function(){e=window.widget,delete window.widget,r()},getHeight:function(){return e.getHeight()},getDefaultTitle:function(){return e.getDefaultTitle()},getTitle:function(){return e.getTitle()},getPreference:function(t){return e.getPreference(t)},openURL:function(t){e.openURL(t)},setHttpCredentials:function(t,n){e.setHttpCredentials(t,n)},setPreference:function(t,n){e.setPreferenceForKey(t,n)},setTitle:function(t){e.setTitle(t)},registerEvent:function(t,n,r){r===undefined&&(r=null),e.addWidgetEventListener(t,n,r)},unregisterEvent:function(t,n){n===undefined&&(n=null),e.removeWidgetEventListener(t,n)},fireEvent:function(t,n,r){r===undefined&&(r=null),e.fireWidgetEvent(r,t,n)},trace:function(){this.fireEvent(n,[e.id,null],t)},httpGet:function(t,n,r,i){e.httpGet(t,n,r,i)},httpGetJSON:function(t,n,r,i){e.httpGetJSON(t,n,r,i)},httpPost:function(t,n,r,i,s){e.httpPost(t,n,r,s,i)}};return i}()),ModularMVC.registerMVCHelper("Language",function(e,t){return t.translatePage=function(n){var r=t.getCurrentLanguage();e("#"+n).find("[lang='en']").each(function(){e(this).html(t.translate(e(this).html())).attr("lang",r)})},t}(jQuery,YALM)),ModularMVC.registerMVCHelper("Notification",function(e){var t={create:function(t){e().fireEvent(r,t,n)},show:function(t){e().fireEvent(i,t,n)},cancel:function(t){e().fireEvent(s,t,n)}},n="pleWidgetEngine",r="http://ple.tugraz.at/ns/event/notification/create",i="http://ple.tugraz.at/ns/event/notification/show",s="http://ple.tugraz.at/ns/event/notification/cancel";return t}(ModularMVC.MVCHelper("Widget"))),ModularMVC.registerMVCHelper("Template",JSTemplateXInstance),JSTemplateXInstance.selectTemplateLibrary("SJTX"),JSTemplateXInstance.configure({loadIntoDOM:!1,usingTemplatesFiles:!1});